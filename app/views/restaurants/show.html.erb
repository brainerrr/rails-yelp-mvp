<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<h1><%= @restaurant.name %></h1>
<div class="container">
  <p><strong>Address</strong> : <%= @restaurant.address %></p>
  <p><strong>Cuisine</strong> : <%= @restaurant.category %></p>
  <p><strong>Reviews</strong> : </p>
  <% @restaurant.reviews.each do |review| %>
      <li class="list-group-item"><%= review.content %> </li>
    <% end %>
    <%# @count = 0 %>
    <%# @i = 0 %>
  <%# @restaurant.reviews.each do |review| %>
    <%# @count += review.rating.to_i %>
    <%# @i += 1 %>
  <%# end %>
  <%#= @count/i %>
    <span class="heading">User Rating</span>
    <% 5.times do |i|  %>
      <span class="fa fa-star <%= "checked" if i + 1 <= @restaurant.average_rating.to_i  %>"></span>
    <% end %>

    <p><%= (@restaurant.average_rating).round(2) %> average based on <%= @restaurant.reviews.count %> reviews.</p>
    <hr style="border:3px solid #f1f1f1">

    <div class="row">
      <div class="side">
        <div>5 star</div>
      </div>
      <div class="middle">
        <div class="bar-container">
          <div class="bar-5" style="width: <%= @restaurant.count_rating(5) %>%"></div>
        </div>
      </div>
      <div class="side right">
        <div><%= @restaurant.reviews.where(rating: 5).count %></div>
      </div>
      <div class="side">
        <div>4 star</div>
      </div>
      <div class="middle">
        <div class="bar-container">
          <div class="bar-4" style="width: <%= @restaurant.count_rating(4) %>%"></div>
        </div>
      </div>
      <div class="side right">
        <div><%= @restaurant.reviews.where(rating: 4).count %></div>
      </div>
      <div class="side">
        <div>3 star</div>
      </div>
      <div class="middle">
        <div class="bar-container">
          <div class="bar-3" style="width: <%= @restaurant.count_rating(3) %>%"></div>
        </div>
      </div>
      <div class="side right">
        <div><%= @restaurant.reviews.where(rating: 3).count %></div>
      </div>
      <div class="side">
        <div>2 star</div>
      </div>
      <div class="middle">
        <div class="bar-container">
          <div class="bar-2" style="width: <%= @restaurant.count_rating(2) %>%"></div>
        </div>
      </div>
      <div class="side right">
        <div><%= @restaurant.reviews.where(rating: 2).count %></div>
      </div>
      <div class="side">
        <div>1 star</div>
      </div>
      <div class="middle">
        <div class="bar-container">
          <div class="bar-1" style="width: <%= @restaurant.count_rating(1) %>%"></div>
        </div>
      </div>
      <div class="side right">
        <div><%= @restaurant.reviews.where(rating: 1).count %></div>
      </div>
    </div>
    <hr>
  <%= link_to 'Back', restaurants_path, class:'btn btn-outline-secondary' %> |
  <%= link_to 'Leave a review', new_restaurant_review_path(@restaurant), class:'btn btn-outline-secondary' %>
</div>
